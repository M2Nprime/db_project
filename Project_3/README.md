# پروژه نهایی: پیاده‌سازی سیستم فیلم با Django ORM

این پروژه به عنوان بخشی از پروژه پایانی درس پایگاه داده پیاده‌سازی شده است. در این پروژه، یک سیستم مدیریت فیلم با استفاده از ORM فریمورک جنگو پیاده‌سازی شده است که به پایگاه داده از قبل طراحی شده متصل می‌شود.

---

## ساختار مدل‌ها

ساختار پایگاه داده شامل مدل‌های اصلی زیر است:

* **Person**: اطلاعات اشخاص (کارگردانان و بازیگران) را ذخیره می‌کند.
* **Movie**: اطلاعات اصلی فیلم‌ها را شامل می‌شود و با کارگردان (`ForeignKey` به `Person`)، ژانرها و بازیگران (`ManyToManyField`) در ارتباط است.
* **Genre**: ژانرهای مختلف فیلم‌ها را نگهداری می‌کند.
* **User**: اطلاعات کاربران سیستم را ذخیره می‌کند.
* **Rating**: امتیازهای داده شده توسط کاربران به فیلم‌ها را ثبت می‌کند.
* **MovieActor** و **MovieGenre**: جداول واسط برای مدیریت روابط چندبه‌چند.

---

## نحوه اجرای پروژه

برای اجرای این پروژه، مراحل زیر را دنبال کنید:

1.  **نصب پیش‌نیازها:**
    ```bash
    pip install Django mysqlclient
    ```
    *(اگر از پایگاه داده دیگری استفاده می‌کنید، درایور مربوطه را نصب کنید)*

2.  **تنظیمات پایگاه داده:**
    در فایل `settings.py`، اطلاعات اتصال به پایگاه داده‌ای که در پروژه قبلی ساخته‌اید را وارد کنید.

3.  **اجرای Migrationها:**
    ```bash
    python manage.py migrate
    ```

4.  **اجرای اسکریپت کوئری‌ها:**
    برای مشاهده نمونه کوئری‌های پروژه، دستور زیر را اجرا کنید:
    ```bash
    python run_queries.py
    ```

5.  **اجرای سرور جنگو:**
    برای مشاهده پنل ادمین، ابتدا یک ابرکاربر بسازید و سپس سرور را اجرا کنید.
    ```bash
    python manage.py createsuperuser
    python manage.py runserver
    ```

---

## نمونه کوئری‌ها

در فایل `run_queries.py` کوئری‌های مختلفی پیاده‌سازی شده است. در ادامه چند نمونه از آن‌ها آورده شده است:

**۱. پیدا کردن فیلم‌هایی با امتیاز بالای ۸.۵ یا در ژانر درام:**
```python
# (کد کوئری مربوطه را از فایل run_queries.py اینجا کپی کنید)
from django.db.models import Q
high_rated_or_drama = Movie.objects.filter(Q(tmdbscore__gt=8.5) | Q(moviegenre__genreid__genrename='Drama')).distinct()
```

**۲. محاسبه میانگین امتیاز تمام فیلم‌ها:**
```python
# (کد کوئری مربوطه را از فایل run_queries.py اینجا کپی کنید)
from django.db.models import Avg
average_rating = Movie.objects.aggregate(avg_score=Avg('tmdbscore'))
```

**۳. حل مشکل N+1 با `select_related`:**
```python
# (کد بهینه‌سازی شده را اینجا کپی کنید)
movies = Movie.objects.select_related('directorid').all()[:10]
for movie in movies:
    print(f"Movie: {movie.title}, Director: {movie.directorid.fullname}")
```

---

## نحوه استفاده از داده‌های تستی

این پروژه برای داده‌های خود به پایگاه داده از قبل موجود که در **پروژه دوم (طراحی پایگاه داده)** ایجاد شده است، متصل می‌شود. بنابراین، نیازی به وارد کردن داده‌های تستی جداگANE نیست و پروژه با داده‌های واقعی موجود در آن پایگاه داده کار می‌کند.